{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Base Submission Schema",
  "description": "Common schema structure for all threat intelligence submissions",
  "type": "object",
  "required": ["metadata", "dataType", "data"],
  "properties": {
    "metadata": {
      "type": "object",
      "required": ["version", "org", "submissionDate"],
      "properties": {
        "version": {
          "type": "string",
          "pattern": "^\\d+\\.\\d+$",
          "description": "Schema version (e.g., '1.0')",
          "examples": ["1.0", "1.1", "2.0"]
        },
        "org": {
          "type": "string",
          "minLength": 1,
          "maxLength": 50,
          "pattern": "^[a-zA-Z0-9-_]+$",
          "description": "Organization identifier (alphanumeric, hyphens, underscores)",
          "examples": ["org-a", "hospital-west", "health_system_1"]
        },
        "submissionDate": {
          "type": "string",
          "format": "date-time",
          "description": "ISO 8601 timestamp when submission was created",
          "examples": ["2025-01-15T12:00:00Z", "2025-01-15T08:00:00-05:00"]
        },
        "reportingPeriod": {
          "type": "object",
          "required": ["start", "end"],
          "properties": {
            "start": {
              "type": "string",
              "format": "date-time",
              "description": "Start of reporting period"
            },
            "end": {
              "type": "string",
              "format": "date-time",
              "description": "End of reporting period"
            }
          },
          "additionalProperties": false
        },
        "classification": {
          "type": "string",
          "enum": ["TLP:CLEAR", "TLP:GREEN", "TLP:AMBER", "TLP:RED"],
          "default": "TLP:GREEN",
          "description": "Traffic Light Protocol classification"
        },
        "dataSource": {
          "type": "string",
          "minLength": 1,
          "maxLength": 100,
          "description": "Primary source of the telemetry data",
          "examples": [
            "internal-telemetry",
            "edr-telemetry",
            "siem-correlation",
            "incident-response",
            "threat-hunting",
            "malware-analysis",
            "network-monitoring"
          ]
        },
        "recordCount": {
          "type": "integer",
          "minimum": 0,
          "maximum": 10000,
          "description": "Number of records in data array"
        },
        "collectionMethod": {
          "type": "string",
          "enum": ["automated", "manual", "hybrid"],
          "description": "How data was collected"
        },
        "confidence": {
          "type": "integer",
          "minimum": 0,
          "maximum": 100,
          "description": "Overall confidence in data accuracy"
        },
        "tags": {
          "type": "array",
          "items": {
            "type": "string",
            "maxLength": 50
          },
          "maxItems": 20,
          "description": "Optional tags for categorization"
        }
      },
      "additionalProperties": false
    },
    "dataType": {
      "type": "string",
      "enum": ["threatActor", "malware", "technique", "incident", "attackVector"],
      "description": "Type of threat intelligence data"
    },
    "data": {
      "type": "array",
      "minItems": 1,
      "maxItems": 5000,
      "description": "Array of threat intelligence records"
    }
  },
  "additionalProperties": false,
  "definitions": {
    "tlpClassification": {
      "type": "string",
      "enum": ["TLP:CLEAR", "TLP:GREEN", "TLP:AMBER", "TLP:RED"],
      "description": "Traffic Light Protocol classification levels"
    },
    "dateTime": {
      "type": "string",
      "format": "date-time",
      "pattern": "^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(\\.\\d{3})?Z?([+-]\\d{2}:\\d{2})?$"
    },
    "uuid": {
      "type": "string",
      "pattern": "^[a-f0-9]{8}-[a-f0-9]{4}-4[a-f0-9]{3}-[89ab][a-f0-9]{3}-[a-f0-9]{12}$",
      "description": "UUID v4 format"
    },
    "mitreTechniqueId": {
      "type": "string",
      "pattern": "^T\\d{4}(\\.\\d{3})?$",
      "description": "MITRE ATT&CK Technique ID"
    },
    "cveId": {
      "type": "string",
      "pattern": "^CVE-\\d{4}-\\d{4,}$",
      "description": "Common Vulnerabilities and Exposures ID"
    },
    "ipAddress": {
      "oneOf": [
        {
          "type": "string",
          "pattern": "^(\\d{1,3}\\.){3}\\d{1,3}$",
          "description": "IPv4 address"
        },
        {
          "type": "string",
          "pattern": "^([0-9a-fA-F]{0,4}:){7}[0-9a-fA-F]{0,4}$",
          "description": "IPv6 address"
        }
      ]
    },
    "hashValue": {
      "oneOf": [
        {
          "type": "string",
          "pattern": "^[a-fA-F0-9]{32}$",
          "description": "MD5 hash"
        },
        {
          "type": "string",
          "pattern": "^[a-fA-F0-9]{40}$",
          "description": "SHA1 hash"
        },
        {
          "type": "string",
          "pattern": "^[a-fA-F0-9]{64}$",
          "description": "SHA256 hash"
        },
        {
          "type": "string",
          "pattern": "^[a-fA-F0-9]{128}$",
          "description": "SHA512 hash"
        }
      ]
    },
    "healthcareSector": {
      "type": "string",
      "enum": [
        "hospital",
        "insurance",
        "pharma",
        "medical_device",
        "clinic",
        "laboratory",
        "nursing_home",
        "rehabilitation",
        "telehealth",
        "other"
      ]
    },
    "severityLevel": {
      "type": "string",
      "enum": ["critical", "high", "medium", "low", "informational"]
    }
  }
}